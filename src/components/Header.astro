---
import ThemeToggle from "./ThemeToggle.astro";
import SearchBar from "./SearchBar.astro"; // Assuming you will create this
import "../styles/global.css";

export interface Props {
      subjects: string[];
}
const { subjects = [] } = Astro.props as Props;
---

<header
      class="w-full border-b border-gray-200 dark:border-gray-800 bg-white/80 dark:bg-gray-900/80 backdrop-blur sticky top-0 z-30"
>
      <nav
            class="max-w-4xl mx-auto flex items-center justify-between px-4 py-3"
      >
            <a
                  href="/"
                  class="font-bold text-lg tracking-tight flex items-center gap-2"
            >
                  <svg
                        class="w-6 h-6 text-blue-600 dark:text-blue-400"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        viewBox="0 0 24 24"
                        ><path d="M5 12h14M12 5l7 7-7 7"></path></svg
                  >
                  Note Crack
            </a>
            <div class="flex items-center gap-3">
                  <!-- Subjects Dropdown -->

                  <div class="relative" id="subjects-dropdown-wrapper">
                        <button
                              id="subjects-button"
                              class="px-3 py-1 rounded hover:bg-gray-100 dark:hover:bg-gray-800 transition font-medium"
                        >
                              Subjects
                        </button>
                        <div
                              id="subjects-menu"
                              class="absolute left-0 mt-2 w-40 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded shadow-lg opacity-0 pointer-events-none transition-opacity z-40"
                        >
                              <ul>
                                    {
                                          subjects.map((subject) => (
                                                <li>
                                                      <a
                                                            href={`/${subject}`}
                                                            class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 capitalize"
                                                      >
                                                            {subject}
                                                      </a>
                                                </li>
                                          ))
                                    }
                              </ul>
                        </div>
                  </div>
                  {(<SearchBar />)}
                  <!-- THIS IS THE CHANGE -->
                  <ThemeToggle />
            </div>
      </nav>
</header>

<script>
      const wrapper = document.getElementById("subjects-dropdown-wrapper");
      const button = document.getElementById("subjects-button");
      const menu = document.getElementById("subjects-menu");

      button.addEventListener("click", (event) => {
            event.stopPropagation(); // Prevent click from bubbling up to the document
            menu.classList.toggle("opacity-0");
            menu.classList.toggle("pointer-events-none");
      });

      // Close dropdown if clicked outside
      document.addEventListener("click", () => {
            if (!menu.classList.contains("opacity-0")) {
                  menu.classList.add("opacity-0");
                  menu.classList.add("pointer-events-none");
            }
      });
</script>
