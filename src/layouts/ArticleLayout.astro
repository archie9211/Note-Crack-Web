---
import BaseLayout from "./BaseLayout.astro";
import ReadingProgressBar from "../components/ReadingProgressBar.astro";
---

<BaseLayout>
      <Fragment slot="head">
            <slot name="head" />
      </Fragment>
      <ReadingProgressBar />

      <div class="max-w-8xl mx-auto w-full relative px-4 sm:px-6 lg:px-8">
            <div class="lg:grid lg:grid-cols-[260px_1fr_260px] lg:gap-x-8">
                  <aside
                        class="hidden lg:block sticky top-20 self-start h-[calc(100vh-5rem)] overflow-y-auto pb-8 pr-4"
                  >
                        <slot name="left-sidebar" />
                  </aside>

                  <div class="min-w-0">
                        <div
                              id="mobile-toggle-bar"
                              class="sticky top-16 bg-white/90 dark:bg-gray-900/90 backdrop-blur-sm z-20 py-2 border-b border-gray-200 dark:border-gray-800 lg:hidden -mx-4 sm:-mx-6 px-4 sm:px-6 transition-transform duration-300"
                        >
                              <slot name="mobile-toggles" />
                        </div>
                        <main class="py-8">
                              <slot name="main-content" />
                        </main>
                  </div>

                  <aside
                        class="hidden lg:block sticky top-20 self-start h-[calc(100vh-5rem)] overflow-y-auto pb-8 pl-4"
                  >
                        <slot name="right-sidebar" />
                  </aside>
            </div>
      </div>

      <div
            id="mobile-nav-backdrop"
            class="fixed inset-0 bg-black/30 z-40 hidden lg:hidden"
      >
      </div>

      <div
            id="mobile-nav-drawer"
            class="fixed top-0 left-0 h-full w-72 max-w-[80vw] bg-white dark:bg-gray-900 z-50 transform -translate-x-full transition-transform duration-300 ease-in-out lg:hidden"
      >
            <div class="p-4 overflow-y-auto h-full">
                  <slot name="mobile-nav-drawer" />
            </div>
      </div>

      <div
            id="mobile-toc-drawer"
            class="fixed bottom-0 left-0 w-full bg-white dark:bg-gray-900 z-40 p-6 border-t border-gray-200 dark:border-gray-700 transform translate-y-full transition-transform duration-300 ease-in-out lg:hidden"
      >
            <div class="max-h-[50vh] overflow-y-auto">
                  <slot name="mobile-toc" />
            </div>
      </div>
</BaseLayout>
